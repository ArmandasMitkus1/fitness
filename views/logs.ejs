<!DOCTYPE html>
<html lang="en">
<head>
    <%- include('partials/head') %>
</head>
<body>
    <%- include('partials/header') %>
    <main>
        <h2><%= pageTitle %></h2>
        
        <% if (success) { %>
            <p class="success-message">Workout successfully recorded!</p>
        <% } %>

        <form action="/logs" method="GET" class="search-form">
            <input type="text" name="search" placeholder="Search by Workout Type" value="<%= searchTerm %>">
            <label for="start_date">Start Date:</label>
            <input type="date" name="start_date" value="<%= startDate %>">
            <label for="end_date">End Date:</label>
            <input type="date" name="end_date" value="<%= endDate %>">
            <button type="submit">Search Logs</button>
            <a href="/logs" class="button-link">Clear Search</a>
        </form>

        <div class="summary-stats">
            <h3>Total Progress</h3>
            <p>Total Workouts: <strong><%= summary.total_workouts %></strong></p>
            <p>Total Duration: <strong><%= summary.total_duration %> min</strong></p>
            <p>Total Calories: <strong><%= summary.total_calories %> kcal</strong></p>
        </div>

        <% if (logs.length > 0) { %>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Type</th>
                        <th>Duration (mins)</th>
                        <th>Calories</th>
                    </tr>
                </thead>
                <tbody>
                    <% logs.forEach(log => { %>
                        <tr>
                            <td><%= new Date(log.workout_date).toLocaleDateString() %></td>
                            <td><%= log.workout_type %></td>
                            <td><%= log.duration_minutes %></td>
                            <td><%= log.calories_burned %></td>
                        </tr>
                    <% }) %>
                </tbody>
            </table>
        <% } else { %>
            <p>No workout logs found matching your criteria. <a href="/add-workout">Add one now!</a></p>
        <% } %>

    </main>
    <%- include('partials/footer') %>
</body>
</html>
